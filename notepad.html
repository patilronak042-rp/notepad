<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Advanced Notepad</title>
<style>
    :root {
        --bg-color: #f5f5f5;
        --text-color: #333;
        --sidebar-bg: #2c3e50;
        --sidebar-text: #fff;
        --active-note: #1abc9c;
        --button-bg: #1abc9c;
        --button-hover: #16a085;
    }

    [data-theme="dark"] {
        --bg-color: #1e1e1e;
        --text-color: #f5f5f5;
        --sidebar-bg: #34495e;
        --sidebar-text: #fff;
        --active-note: #16a085;
        --button-bg: #16a085;
        --button-hover: #1abc9c;
    }

    body {
        margin: 0;
        font-family: Arial, sans-serif;
        display: flex;
        height: 100vh;
        background-color: var(--bg-color);
        color: var(--text-color);
    }

    #sidebar {
        width: 220px;
        background-color: var(--sidebar-bg);
        color: var(--sidebar-text);
        display: flex;
        flex-direction: column;
        padding: 10px;
    }

    #sidebar h2 {
        text-align: center;
        margin-bottom: 10px;
    }

    #searchInput {
        padding: 5px;
        border-radius: 4px;
        border: none;
        margin-bottom: 10px;
    }

    #notesList {
        flex: 1;
        overflow-y: auto;
    }

    .note-item {
        background-color: #34495e;
        padding: 10px;
        margin: 5px 0;
        border-radius: 4px;
        cursor: pointer;
        word-wrap: break-word;
    }

    .note-item.active {
        background-color: var(--active-note);
    }

    button {
        padding: 8px 12px;
        margin: 5px 0;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        background-color: var(--button-bg);
        color: white;
        font-weight: bold;
    }

    button:hover {
        background-color: var(--button-hover);
    }

    #main {
        flex: 1;
        display: flex;
        flex-direction: column;
        padding: 10px;
    }

    #noteTitle {
        font-size: 1.2em;
        padding: 5px;
        margin-bottom: 10px;
        border: 1px solid #ccc;
        border-radius: 4px;
    }

    #noteContent {
        flex: 1;
        padding: 10px;
        font-size: 1em;
        border: 1px solid #ccc;
        border-radius: 4px;
        resize: none;
    }

    #footerButtons {
        margin-top: 10px;
    }
</style>
</head>
<body data-theme="light">

<div id="sidebar">
    <h2>Notes</h2>
    <input type="text" id="searchInput" placeholder="Search..." oninput="searchNotes()">
    <button onclick="createNote()">+ New Note</button>
    <div id="notesList"></div>
    <button onclick="toggleTheme()">Toggle Dark/Light</button>
    <button onclick="exportNotes()">Export Notes</button>
</div>

<div id="main">
    <input type="text" id="noteTitle" placeholder="Note Title" oninput="updateNote()" />
    <textarea id="noteContent" placeholder="Start typing..." oninput="updateNote()"></textarea>
    <div id="footerButtons">
        <button onclick="deleteNote()">Delete Note</button>
    </div>
</div>

<script>
let notes = JSON.parse(localStorage.getItem('notes')) || [];
let currentNoteId = null;

const notesList = document.getElementById('notesList');
const noteTitle = document.getElementById('noteTitle');
const noteContent = document.getElementById('noteContent');
const searchInput = document.getElementById('searchInput');

function saveNotes() {
    localStorage.setItem('notes', JSON.stringify(notes));
}

function renderNotes(filter = '') {
    notesList.innerHTML = '';
    notes.forEach((note, index) => {
        if (note.title.toLowerCase().includes(filter.toLowerCase()) || note.content.toLowerCase().includes(filter.toLowerCase())) {
            const div = document.createElement('div');
            div.className = 'note-item' + (currentNoteId === index ? ' active' : '');
            div.textContent = note.title || 'Untitled';
            div.onclick = () => loadNote(index);
            notesList.appendChild(div);
        }
    });
}

function createNote() {
    notes.push({ title: '', content: '' });
    currentNoteId = notes.length - 1;
    renderNotes(searchInput.value);
    loadNote(currentNoteId);
    saveNotes();
}

function loadNote(id) {
    currentNoteId = id;
    const note = notes[id];
    noteTitle.value = note.title;
    noteContent.value = note.content;
    renderNotes(searchInput.value);
}

function updateNote() {
    if (currentNoteId === null) return;
    notes[currentNoteId].title = noteTitle.value;
    notes[currentNoteId].content = noteContent.value;
    renderNotes(searchInput.value);
    saveNotes();
}

function deleteNote() {
    if (currentNoteId === null) return;
    if(confirm("Are you sure you want to delete this note?")) {
        notes.splice(currentNoteId, 1);
        currentNoteId = notes.length ? 0 : null;
        if(currentNoteId !== null) loadNote(currentNoteId);
        else {
            noteTitle.value = '';
            noteContent.value = '';
        }
        renderNotes(searchInput.value);
        saveNotes();
    }
}

function searchNotes() {
    renderNotes(searchInput.value);
}

function toggleTheme() {
    const body = document.body;
    body.dataset.theme = body.dataset.theme === 'light' ? 'dark' : 'light';
}

function exportNotes() {
    const blob = new Blob([JSON.stringify(notes, null, 2)], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'notes_backup.json';
    a.click();
    URL.revokeObjectURL(url);
}

// Load first note on page load
if(notes.length) {
    loadNote(0);
}
renderNotes();
</script>

</body>
</html>
